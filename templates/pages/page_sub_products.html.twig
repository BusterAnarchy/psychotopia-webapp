{% extends 'base.html.twig' %}

{% block title %} Sous produits - {{ molecule.label }} {% endblock %}
{% block centerText %} Sous produits - {{ molecule.label }} {% endblock %}

{% block body %}
<div class="analysis-page">

    {% include "components/ui/molecule_nav.html.twig" with { molecule: molecule } %}
    {% include "components/ui/molecule_header.html.twig" %}

    {% include "components/ui/filter/filter_drawer.html.twig" with { form_template: "components/forms/form_cut.html.twig" } %}
    {% include "components/ui/filter/filter_drawer_trigger.html.twig" %}

    <section class="info-panel container">
        <p>
            Un sous-produit est un produit accessoire ou secondaire issu de la fabrication,
            la production, la réaction ou la synthèse d'une molécule.
        </p>
    </section>

    {% include "components/ui/grid_layout_controls.html.twig" %}

    <section class="analysis-grid container">
        {% include "components/ui/analysis_card.html.twig" with {
            embed_chart: 'sub_product_distribution',
            
            title: "Proportion par sous-produit",
            description:  "Parmi les échantillons contenant un ou plusieurs sous-produits, voici la proportion pour chacun d'entre eux.",
            
            body_template: "components/charts/chart_bar_x.html.twig",
            body_context: { id:"bar_chart", chart_data: results.histo_sub_products | json_encode }
        } %}

        {% include "components/ui/analysis_card.html.twig" with {
            embed_chart: 'sub_product_timeline',
            
            title: "Évolution temporelle des sous-produits",
            description: "Parmi les échantillons comportant un ou plusieurs sous-produits, voici l'évolution temporelle (par bimestre) de la présence de chacun.",
            
            body_template: "components/charts/chart_area_stacked.html.twig",
            body_context: { id:"area_chart", chart_data: results.temporal_sub_products | json_encode, is_stacked:'false', mode:'relatif' }
        } %}
    </section>
</div>
{% endblock %}
