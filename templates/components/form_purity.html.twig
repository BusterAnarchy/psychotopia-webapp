{# templates/components/form_purity.html.twig — version refondue #}

<div class="form-card">
    <div class="form-card__body">

        <div class="form-field">
            <label for="date_debut" class="form-label">Choisir une date de début :</label>
            <input type="date" id="date_debut" class="form-input">
        </div>

        <div class="form-field">
            <label for="date_fin" class="form-label">Choisir une date de fin :</label>
            <input type="date" id="date_fin" class="form-input">
        </div>

        <div class="form-field">
            <label for="range_val" class="form-label">Nombre de jours (Δ) pour moyenner :</label>

            <div class="form-range">
                <input type="range"
                       class="form-range__input"
                       min="1"
                       max="30"
                       id="range_val"
                       value="15"
                       oninput="rangeOutput.value = range_val.value">
                <output id="rangeOutput" class="form-range__output">15</output>
            </div>
        </div>

        {% if molecule.label == "3-MMC" %}
        <div class="form-field form-field--center">
            <span class="form-label">Seulement les échantillons contenant de la 3-MMC</span>

            <label class="switch">
                <input type="checkbox" id="no_cut">
                <span class="slider"></span>
            </label>
        </div>
        {% endif %}

        <button id="sendButton" class="btn btn--primary btn--block">Envoyer</button>
    </div>
</div>

<script>
document.getElementById('sendButton').addEventListener('click', function () {
    const date_debut = document.getElementById('date_debut').value;
    const date_fin = document.getElementById('date_fin').value;
    const range = document.getElementById('range_val').value;

    const params = new URLSearchParams();
    if (date_debut) params.set('date_debut', date_debut);
    if (date_fin) params.set('date_fin', date_fin);
    if (range) params.set('range', range);

    const cutBox = document.getElementById('no_cut');
    if (cutBox && cutBox.checked) params.set('no_cut', 'true');

    window.location = window.location.pathname + '?' + params.toString();
});
</script>
