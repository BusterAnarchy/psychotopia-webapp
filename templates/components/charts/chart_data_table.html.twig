{% set table_id = (chart_id ~ '_table') %}
{% set caption_id = table_id ~ '_caption' %}
{% set title_id = table_id ~ '_title' %}
{% set region_label = table_title|default('Lecture alternative du graphique') %}
{% set caption_text = table_caption|default('Tableau des données correspondant au graphique ci-dessus.') %}
{% set panel_id = table_id ~ '_panel' %}

<div
    class="chart-data-table chart-wrapper__table"
    data-chart-table
    data-chart-id="{{ chart_id }}"
    data-chart-payload="{{ chart_data_json|e('html_attr') }}"
    data-chart-config="{{ table_config|json_encode|e('html_attr') }}"
>
    <button
        type="button"
        class="analysis-card__desc-toggle chart-data-table__toggle"
        data-chart-table-toggle
        data-chart-table-default="closed"
        aria-expanded="false"
        aria-controls="{{ panel_id }}"
        data-label-open="Masquer les données"
        data-label-closed="Afficher les données"
    >
        <span class="chart-data-table__title">{{ region_label }}</span>
        <span class="chart-data-table__status" data-chart-table-toggle-label>Afficher les données</span>
        <span class="analysis-card__desc-toggle-icon" aria-hidden="true"></span>
    </button>
    <div
        class="chart-data-table__panel"
        id="{{ panel_id }}"
        data-chart-table-panel
        hidden
    >
        <div
            class="chart-data-table__wrapper"
            role="region"
            aria-live="polite"
            aria-labelledby="{{ title_id }}"
        >
            <table class="chart-table" id="{{ table_id }}">
                <caption id="{{ caption_id }}">{{ caption_text }}</caption>
                <thead></thead>
                <tbody></tbody>
            </table>
        </div>
        <p class="chart-data-table__notice">
            Ces valeurs sont strictement identiques à celles utilisées pour générer le graphique.
        </p>
    </div>
</div>
