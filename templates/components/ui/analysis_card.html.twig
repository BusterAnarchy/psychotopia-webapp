{% set desc_open = description_open is defined ? description_open : true %}

{% set body_content = body_content is defined ? body_content : null %}
{% if body_template is defined and body_template %}
    {% set body_content = include(body_template, body_context|default({})) %}
{% endif %}

<article
    id="card-{{ embed_chart }}"

    class="analysis-card has-description"
    data-analysis-card
    data-card-title="{{ title }}" 
    data-embed-chart="{{ embed_chart }}"
>
    <header class="analysis-card__head">
        <h3 class="analysis-card__title">{{ title }}</h3>
    </header>

    <div class="analysis-card__body">     
        <div class="analysis-card__main">
            {{ body_content|raw }}
        </div>

        <aside
            class="analysis-card__desc-panel {% if desc_open %} is-open{% endif %}"
            data-card-description
        >
            <button
                type="button"
                class="analysis-card__desc-toggle"
                data-card-description-toggle
                aria-expanded="{{ desc_open ? 'true' : 'false' }}"
                data-label-open="{{ description_toggle_label_open|default('Masquer la description') }}"
                data-label-closed="{{ description_toggle_label_closed|default('Afficher la description') }}"
            >
                <span data-card-description-toggle-label>
                    {{ desc_open ? description_toggle_label_open|default('Masquer la description') : description_toggle_label_closed|default('Afficher la description') }}
                </span>
                <span class="analysis-card__desc-toggle-icon" aria-hidden="true"></span>
            </button>
            <div class="analysis-card__desc-content" data-card-description-content>
                {{ description | raw }}
            </div>
        </aside>
    </div>
</article>
